# Run command
# docker compose -f docker-compose.yml up --build
services:
  fpm-nginx:
    build:
      context: .
      dockerfile: .docker/production/Dockerfile
      args:
        - USER_ID=${USERID:-1000}
        - GROUP_ID=${GROUPID:-1000}
    ports:
      - "${APP_PORT:-0}:8080"
    restart: unless-stopped
    # https://serversideup.net/open-source/docker-php/docs/reference/environment-variable-specification
    # https://serversideup.net/open-source/docker-php/docs/getting-started/default-configurations#default-php-extensions
    environment:
      AUTORUN_ENABLED: "true" # Enable or disable all automations. It's advised to set this to false in certain CI environments (especially during a composer install). If this is set to false, all AUTORUN_* behaviors will also be disabled.
      PHP_MEMORY_LIMIT: "128M" # Set the maximum amount of memory in bytes that a script is allowed to allocate. (https://www.php.net/manual/en/ini.core.php#ini.memory-limit) DEFAULT 20M
      PHP_POST_MAX_SIZE: "20M" # Sets max size of post data allowed. (https://www.php.net/manual/en/ini.core.php#ini.post-max-size) DEFAULT 8M
      PHP_UPLOAD_MAX_FILE_SIZE: "10M" # The maximum size of an uploaded file. (https://www.php.net/manual/en/ini.core.php#ini.upload-max-filesize) DEFAULT 10M
    # volumes:
    # - ./app/.env:/var/www/html/.env:ro
    # - ./app/database/database.sqlite:/var/www/html/database/database.sqlite
    # - ./app/storage:/var/www/html/storage
